<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Playwright Locators Playground</title>
  <style>
    :root{--bg:#0b1020;--card:#121938;--muted:#9aa3b2;--accent:#6ee7b7;--danger:#fecaca;--ok:#bbf7d0;--ink:#e6e9f2}
    *{box-sizing:border-box}
    body{margin:0;font:16px/1.5 system-ui,Segoe UI,Roboto,Arial;background:linear-gradient(180deg,#0b1020,#0b0f1a);color:var(--ink)}
    header{display:flex;gap:12px;align-items:center;justify-content:space-between;padding:16px 20px;background:#0d1430;position:sticky;top:0}
    header a{color:#a5b4fc;text-decoration:none;font-weight:600}
    .container{max-width:1000px;margin:24px auto;padding:0 16px}
    .cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:16px}
    .card{background:var(--card);border:1px solid #1f2755;border-radius:14px;padding:14px;box-shadow:0 6px 20px #00000066}
    .card h3{margin:0 0 8px}
    .toolbar{display:flex;flex-wrap:wrap;gap:8px;margin:10px 0 16px}
    .btn{padding:8px 12px;border-radius:10px;border:1px solid #2b356e;background:#16204a;color:#fff;cursor:pointer}
    .btn:hover{filter:brightness(1.1)}
    .btn[aria-pressed="true"]{outline:2px solid var(--accent)}
    .btn-danger{border-color:#7f1d1d;background:#451a1a}
    .btn-ghost{background:transparent;border-color:#334155}
    input,select{width:100%;padding:10px;border-radius:10px;border:1px solid #2b356e;background:#0f1536;color:#fff}
    label{display:block;margin:6px 0;color:var(--muted)}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .list{display:grid;gap:10px;margin-top:8px}
    .item{display:grid;grid-template-columns:56px 1fr auto;align-items:center;gap:10px;border:1px dashed #27306e;border-radius:12px;padding:10px}
    .item img{width:56px;height:56px;border-radius:10px;object-fit:cover;border:1px solid #2b356e}
    .item .meta{display:flex;flex-direction:column}
    .badge{display:inline-block;font-size:12px;border:1px solid #334155;border-radius:999px;padding:2px 8px;color:#9fb0ff}
    .promo{outline:2px dashed #fbbf24}
    .muted{color:var(--muted)}
    .ok{background:linear-gradient(90deg,#063,#0a4);padding:10px;border-radius:12px}
    .status{margin-top:12px;padding:10px;border-radius:12px;background:#0f1536;border:1px solid #24306d}
    .hidden{display:none}
    footer{margin:36px 0 24px;color:#7d89a6;text-align:center}
    code{background:#0f1536;padding:2px 6px;border-radius:6px;border:1px solid #2b356e}
  </style>
</head>
<body>
  <header>
    <nav aria-label="Menu principal">
      <a class="nav-link" href="#catalogo" title="Ir ao catálogo">Catálogo</a>
      <a class="nav-link" href="#sobre">Sobre</a>
    </nav>
    <div class="toolbar">
      <!-- role + aria-pressed para locator por role/state -->
      <button class="btn" role="button" aria-pressed="false" id="toggleTheme" data-testid="btn-theme" title="Alternar tema">Alternar tema</button>
      <!-- data-cy para locator por atributo custom -->
      <button class="btn btn-ghost" data-cy="btn-reset" aria-label="Limpar filtros">Limpar filtros</button>
    </div>
  </header>

  <main id="catalogo" class="container">
    <h1 data-testid="titulo">Playwright Locators Playground</h1>
    <p class="muted">Página simples para treinar <strong>vários tipos de seletores</strong> no Playwright: por <em>texto</em>, <em>role ARIA</em>, <em>id</em>, <em>classe</em>, <em>name</em>, <em>placeholder</em>, <em>alt</em>, <em>data-*</em>, <em>atributo</em>, <em>hierarquia</em>, <em>nth-child</em> e outros.</p>

    <!-- FILTROS -->
    <section class="card" aria-labelledby="filtrosTitulo">
      <h3 id="filtrosTitulo">Filtros</h3>
      <div class="row">
        <!-- locator por placeholder / por label encadeado -->
        <label>Título contém
          <input type="search" name="busca" placeholder="Busque pelo nome" />
        </label>
        <!-- locator por select e por id -->
        <label for="categoria">Categoria</label>
        <select id="categoria" name="categoria">
          <option value="">Todas</option>
          <option value="organico">Orgânico</option>
          <option value="convencional">Convencional</option>
        </select>
      </div>
      <div class="toolbar">
        <!-- locator por texto exato/contém texto -->
        <button class="btn" data-testid="aplicar-filtros">Aplicar filtros</button>
        <button class="btn btn-danger" data-action="mostrar-alerta" aria-controls="alerta">Mostrar alerta</button>
      </div>
      <div id="alerta" class="status hidden" role="status" aria-live="polite"></div>
    </section>

    <!-- CATÁLOGO -->
    <section class="card" aria-labelledby="catalogoTitulo">
      <h3 id="catalogoTitulo">Catálogo</h3>
      <ul class="list" id="listaProdutos">
        <!-- Cada item varia atributos para praticar locators -->
        <li class="item" data-sku="A100" data-category="organico">
          <img alt="maçã vermelha" src="https://picsum.photos/seed/maca/100/100" />
          <div class="meta">
            <strong class="nome">Maçã Gala</strong>
            <span class="badge">Orgânico</span>
            <small class="muted" title="Preço atual">R$ <span class="preco">5,99</span></small>
            <a href="#detalhes" class="detalhes">Ver detalhes</a>
          </div>
          <div>
            <!-- por classe, por atributo data-action, por role=button -->
            <button class="btn btn-ghost btn-promo" data-action="toggle-promo" aria-label="Marcar como promoção">Promo</button>
          </div>
        </li>
        <li class="item" data-sku="B200" data-category="convencional">
          <img alt="banana madura" src="https://picsum.photos/seed/banana/100/100" />
          <div class="meta">
            <strong class="nome">Banana Prata</strong>
            <span class="badge">Convencional</span>
            <small class="muted">R$ <span class="preco">3,49</span></small>
            <a href="#detalhes" class="detalhes">Mais infos</a>
          </div>
          <div>
            <button class="btn btn-ghost btn-promo" data-action="toggle-promo">Promo</button>
          </div>
        </li>
        <li class="item" data-sku="C300" data-category="organico">
          <img alt="laranja" src="https://picsum.photos/seed/laranja/100/100" />
          <div class="meta">
            <strong class="nome" data-testid="terceiro-item">Laranja Bahia</strong>
            <span class="badge">Orgânico</span>
            <small class="muted">R$ <span class="preco">4,79</span></small>
            <a href="#detalhes" class="detalhes" title="Abrir detalhes">Abrir</a>
          </div>
          <div>
            <button class="btn btn-ghost btn-promo" data-action="toggle-promo">Promo</button>
          </div>
        </li>
      </ul>

      <!-- Form sem ids em todos os campos para praticar name/placeholder/label/atributos -->
      <form class="card" id="formNovo" data-testid="form-novo" aria-labelledby="novoTitulo">
        <h3 id="novoTitulo">Incluir item</h3>
        <div class="row">
          <label>Nome
            <input name="nome" placeholder="Ex.: Kiwi" />
          </label>
          <label>Preço (R$)
            <input type="number" min="0" step="0.01" data-qa="preco" placeholder="0,00" />
          </label>
        </div>
        <div class="row">
          <label for="selCategoria">Categoria</label>
          <select id="selCategoria" aria-label="Categoria do item">
            <option value="organico">Orgânico</option>
            <option value="convencional">Convencional</option>
          </select>
          <label>
            <input type="checkbox" aria-label="Marcar como promoção ao incluir" data-role="promo" />
            Já entra em promoção
          </label>
        </div>
        <div class="toolbar">
          <!-- por name e por texto -->
          <button class="btn" name="salvar">Incluir item</button>
          <button type="button" class="btn btn-ghost" data-testid="btn-exemplo-css">Exemplo CSS (pinta 3º)</button>
        </div>
        <div id="msg" class="status" role="status" aria-live="polite"></div>
      </form>
    </section>

    <!-- SOBRE -->
    <section id="sobre" class="card" aria-labelledby="sobreTitulo">
      <h3 id="sobreTitulo">Sobre</h3>
      <p>Use esta página para treinar:</p>
      <ul>
        <li>locator.getByText('Aplicar filtros')</li>
        <li>locator.getByRole('button', { name: 'Promo' })</li>
        <li>locator.getByPlaceholder('Busque pelo nome')</li>
        <li>locator.getByLabel('Categoria')</li>
        <li>locator.getByAltText('maçã vermelha')</li>
        <li>locator.locator('[data-sku="C300"]')</li>
        <li>locator.locator('.item:nth-child(3) .nome')</li>
        <li>locator.getByTestId('form-novo')</li>
        <li>locator.locator('[data-qa="preco"]')</li>
      </ul>
    </section>

    <div class="ok hidden" id="toast" role="alert">Ação realizada com sucesso!</div>
  </main>

  <footer>
    <small>Feito para treinar locators do Playwright. Dica: abra o DevTools e brinque com <code>$$(selector)</code>.</small>
  </footer>

  <script>
    const qs = (s, el=document) => el.querySelector(s);
    const qsa = (s, el=document) => Array.from(el.querySelectorAll(s));

    // Alternar tema claro/escuro apenas para demonstrar getByRole + state
    const themeBtn = qs('#toggleTheme');
    themeBtn.addEventListener('click', () => {
      const pressed = themeBtn.getAttribute('aria-pressed') === 'true';
      themeBtn.setAttribute('aria-pressed', String(!pressed));
      document.body.style.filter = pressed ? 'none' : 'hue-rotate(20deg)';
    });

    // Limpar filtros
    qs('[data-cy="btn-reset"]').addEventListener('click', () => {
      const busca = qs('input[placeholder="Busque pelo nome"]');
      const cat = qs('#categoria');
      if (busca) busca.value = '';
      if (cat) cat.value = '';
      filtrar();
      flash('Filtros limpos.');
    });

    // Aplicar filtros
    qs('[data-testid="aplicar-filtros"]').addEventListener('click', () => filtrar());

    function filtrar(){
      const termo = (qs('input[placeholder="Busque pelo nome"]').value || '').toLowerCase();
      const categoria = qs('#categoria').value;
      qsa('#listaProdutos .item').forEach(li => {
        const nome = qs('.nome', li).textContent.toLowerCase();
        const cat = li.getAttribute('data-category');
        const matchNome = !termo || nome.includes(termo);
        const matchCat = !categoria || cat === categoria;
        li.style.display = (matchNome && matchCat) ? '' : 'none';
      });
    }

    // Mostrar alerta (por texto/aria-controls)
    qsa('[data-action="mostrar-alerta"]').forEach(btn => btn.addEventListener('click', () => {
      const box = qs('#alerta');
      box.textContent = 'Atenção: isto é apenas um alerta de exemplo!';
      box.classList.remove('hidden');
      setTimeout(()=> box.classList.add('hidden'), 2000);
    }));

    // Marcar/Desmarcar Promo (por data-action e classe)
    qsa('[data-action="toggle-promo"]').forEach(btn => btn.addEventListener('click', (e) => {
      const li = e.currentTarget.closest('.item');
      li.classList.toggle('promo');
      flash(li.classList.contains('promo') ? 'Item marcado como PROMO.' : 'Item removido da PROMO.');
    }));

    // Incluir item (por name="salvar")
    qs('button[name="salvar"]').addEventListener('click', (e) => {
      e.preventDefault();
      const form = qs('[data-testid="form-novo"]');
      const nome = qs('input[name="nome"]', form).value.trim();
      const preco = qs('[data-qa="preco"]', form).value.trim();
      const categoria = qs('#selCategoria', form).value;
      const entraPromo = qs('input[type="checkbox"][data-role="promo"]', form).checked;
      if(!nome || !preco){
        msg('Preencha nome e preço.');
        return;
      }
      const sku = gerarSKU();
      const li = document.createElement('li');
      li.className = 'item' + (entraPromo ? ' promo' : '');
      li.setAttribute('data-sku', sku);
      li.setAttribute('data-category', categoria);
      li.innerHTML = `
        <img alt="${nome}" src="https://picsum.photos/seed/${encodeURIComponent(nome)}/100/100" />
        <div class="meta">
          <strong class="nome">${nome}</strong>
          <span class="badge">${categoria === 'organico' ? 'Orgânico' : 'Convencional'}</span>
          <small class="muted">R$ <span class="preco">${Number(preco).toFixed(2)}</span></small>
          <a href="#detalhes" class="detalhes">Detalhes</a>
        </div>
        <div>
          <button class="btn btn-ghost btn-promo" data-action="toggle-promo">Promo</button>
        </div>`;
      qs('#listaProdutos').appendChild(li);
      // rebind do botão Promo do novo item
      qs('.btn-promo', li).addEventListener('click', (ev)=>{
        const item = ev.currentTarget.closest('.item');
        item.classList.toggle('promo');
        flash(item.classList.contains('promo') ? 'Item marcado como PROMO.' : 'Item removido da PROMO.');
      });
      msg(`Item "${nome}" adicionado (SKU ${sku}).`);
      flash('Item incluído.');
      form.reset();
    });

    // Botão exemplo CSS: estiliza o 3º item com nth-child
    qs('[data-testid="btn-exemplo-css"]').addEventListener('click',()=>{
      const terceiro = qs('.list .item:nth-child(3)');
      if(terceiro){
        terceiro.style.boxShadow = '0 0 0 3px #22c55e';
        flash('3º item destacado com :nth-child(3).');
      }
    });

    function gerarSKU(){
      const n = Math.floor(Math.random()*900 + 100); // 100..999
      const letra = String.fromCharCode(65 + Math.floor(Math.random()*26));
      return letra + n;
    }

    function msg(text){
      const box = qs('#msg');
      box.textContent = text;
    }

    function flash(text){
      const t = qs('#toast');
      t.textContent = text;
      t.classList.remove('hidden');
      setTimeout(()=> t.classList.add('hidden'), 1400);
    }
  </script>
</body>
</html>
